angular.module("angular-simple-table",[]).directive("simpleTable",["$filter","$compile","filterFilter",function(a,b,c){"use strict";window.TableSettings=function(b){function c(b,c,d){var e=[],f=c||"$";e[f]=b;var g=a("filter")(d,e,!1);return g}function d(b,c,d){var e=c.split("."),f=[];f[e[1]]=b;var g=[];return d.forEach(function(b,c,d){var h=a("filter")(b[e[0]],f,!1);h.length>0&&g.push(i[c])}),g}function e(a){for(var b={},c=a.length-1;c>=0;c--){var d=JSON.stringify(a[c]);b[d]?a.splice(c,1):b[d]=!0}return a}var f=b||null,g=!1,h=1,i=null,j=25,k=null,l={};this.setReverseSort=function(a){g=a},this.getReverseSort=function(){return g},this.setOrderField=function(a){k=a},this.getOrderField=function(){return k},this.setData=function(a){f=a},this.getData=function(){return f},this.setRows=function(a){this.setPage(1),j=a},this.getRows=function(){return j},this.getPage=function(){return h},this.setPage=function(a){h=a},this.getTotalPagesArray=function(){return i?new Array(Math.ceil(i.length/j)):void 0},this.getTotalPages=function(){return i?Math.ceil(i.length/j):void 0},this.getFilteredData=function(){if(f instanceof Array||"object"!=typeof f||null===f)i=f;else{var b=Object.keys(f);i=f,i=b.map(function(a){return i[a]})}if(Object.keys(l).length){var m=[];for(var n in l)if(l.hasOwnProperty(n)){if(-1===n.indexOf("."))var o=c(l[n],n,i);else var o=d(l[n],n,i);o.forEach(function(a,b,c){m.push(a)})}i=e(m)}if("string"==typeof k&&(i=a("orderBy")(i,k.toLowerCase(),g)),i&&f){var p=(h-1)*j;return p>i.length&&this.setPage(1),i.slice(p,p+j)}i=f},this.search=function(a,b){if(h=1,k=null,l={},arguments.length<2){var b=arguments[1]||"$";l[b]=arguments[0]}else for(var c=1;c<arguments.length;c++){var b=arguments[c];l[b]=arguments[0]}},this.orderBy=function(a,b){k=a,b||(g=!g)}};var d=function(a,c,d){b(c);var e=document.querySelectorAll("[simple-table]"),f=d.simpleTable;for(var g in e)if(e.hasOwnProperty(g)){var h=e[g];d.simpleTable===h.getAttribute("simple-table")&&"TABLE"===h.tagName&&(a.table=e[g])}c.prepend(document.createElement("tHead")),a.$watch(function(){var b=a.table.children[1].children[0];return b},function(c,d){if("undefined"!=typeof c){var e=c,g=a.table.children[0];g.innerHTML="";var h=e.children,i=document.createElement("tr");for(var j in h)if(h.hasOwnProperty(j)){var k=document.createElement("th"),l=h[j].getAttribute("data-sort-by");if(l){var m=h[j].getAttribute("title")||"";k.innerHTML='<a href="javascript:void(0)" ng-click="'+f+".orderBy('"+l+"',true)\" >"+m+'&nbsp;&nbsp;<span ng-show="'+f+".getOrderField() == '"+l+'\'"><span ng-show="!'+f+'.getReverseSort()">&#9650;</span><span ng-show="'+f+'.getReverseSort()">&#9660;</span></span></a>'}else k.innerHTML=h[j].getAttribute("title");i.appendChild(k)}var n=b(i)(a.$parent);g.appendChild(n[0])}})};return{scope:{simpleTable:"&"},restrict:"EA",template:"",link:d}}]);